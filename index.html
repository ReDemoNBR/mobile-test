<div>Proximity Test</div>
<table>
  <thead><tr><th>API</th><th>Property</th><th>Value</th></tr></thead>
  <tr>
    <td rowspan="4">Device Motion</td>
    <td>acceleration</td>
    <td><span id="devicemotion-acceleration">No value</span> m/s<sup>2</sup></td>
  </tr>
  <tr>
    <td>accelerationIncludingGravity</td>
    <td><span id="devicemotion-accelerationIncludingGravity">No value</span> m/s<sup>2</sup></td>
  </tr>
  <tr>
    <td>rotationRate</td>
    <td><span id="devicemotion-rotationRate">No value</span> &deg;/s</td>
  </tr>
  <tr>
    <td>interval</td>
    <td><span id="devicemotion-interval">No value</span> ms</td>
  </tr>
  <tr>
    <td>Device Light</td>
    <td>value</td>
    <td><span id="devicelight">No value</span> lux</td>
  </tr>
  <tr>
    <td rowspan="4">Device Orientation</td>
    <td>absolute</td>
    <td><span id="deviceorientation-absolute">No value</span> &deg;</td>
  </tr>
  <tr>
    <td>alpha</td>
    <td><span id="deviceorientation-alpha">No value</span> &deg;</td>
  </tr>
  <tr>
    <td>beta</td>
    <td><span id="deviceorientation-beta">No value</span> &deg;</td>
  </tr>
  <tr>
    <td>gamma</td>
    <td><span id="deviceorientation-gamma">No value</span> &deg;</td>
  </tr>
  <tr>
    <td rowspan="3">Device Proximity</td>
    <td>max</td>
    <td><span id="deviceproximity-max">Hover your hand over proximity sensor</span> cm</td>
  </tr>
  <tr>
    <td>min</td>
    <td><span id="deviceproximity-min">Hover your hand over proximity sensor</span> cm</td>
  </tr>
  <tr>
    <td>value</td>
    <td><span id="deviceproximity-value">Hover your hand over proximity sensor</span> cm</td>
  </tr>
  <tr>
    <td>User Proximity</td>
    <td>near</td>
    <td><span id="userproximity-near">Hover your hand over proximity sensor</span></td>
  </tr>
  <tr>
    <td rowspan="9">Navigator</td>
    <td>activeVRDisplays</td>
    <td><span id="navigator-activeVRDisplays">No value</span></td>
  </tr>
  <tr>
    <td>languages</td>
    <td><span id="navigator-languages">No value</span></td>
  </tr>
  <tr>
    <td>hardwareConcurrency</td>
    <td><span id="navigator-hardwareConcurrency">No value</span></td>
  </tr>
  <tr>
    <td>getGamepads</td>
    <td><span id="navigator-getGamepads">No value</span></td>
  </tr>
  <tr>
    <td>getVRDisplays</td>
    <td><span id="navigator-getVRDisplays">No value</span></td>
  </tr>
  <tr>
    <td>maxTouchPoints</td>
    <td><span id="navigator-maxTouchPoints">No value</span></td>
  </tr>
  <tr>
    <td>onLine</td>
    <td><span id="navigator-onLine">No value</span></td>
  </tr>
  <tr>
    <td>oscpu</td>
    <td><span id="navigator-oscpu">No value</span></td>
  </tr>
  <tr>
    <td>vibrate</td>
    <td>
      <input type="button" value="vibrate for 1s" onclick="vibrateSample()" />
      <input type="button" value="vibrate SOS in Morse" onclick="vibrateSOS()" />
    </td>
  </tr>
  <tr>
    <td rowspan="4">Battery</td>
    <td>charging</td>
    <td><span id="battery-charging">No value</span></td>
  </tr>
  <tr>
    <td>level</td>
    <td><span id="battery-level">No value</span></td>
  </tr>
  <tr>
    <td>chargingTime</td>
    <td><span id="battery-chargingTime">No value</span></td>
  </tr>
  <tr>
    <td>dischargingTime</td>
    <td><span id="battery-dischargingTime">No value</span></td>
  </tr>
  <tr>
    <td rowspan="10">Screen</td>
    <td>availWidth</td>
    <td><span id="screen-availWidth">No value</span></td>
  </tr>
  <tr>
    <td>availHeight</td>
    <td><span id="screen-availHeight">No value</span></td>
  </tr>
  <tr>
    <td>width</td>
    <td><span id="screen-width">No value</span></td>
  </tr>
  <tr>
    <td>height</td>
    <td><span id="screen-height">No value</span></td>
  </tr>
  <tr>
    <td>colorDepth</td>
    <td><span id="screen-colorDepth">No value</span></td>
  </tr>
  <tr>
    <td>pixelDepth</td>
    <td><span id="screen-pixelDepth">No value</span></td>
  </tr>
  <tr>
    <td>orientation.angle</td>
    <td><span id="screen-orientation.angle">No value</span></td>
  </tr>
  <tr>
    <td>orientation.type</td>
    <td><span id="screen-orientation.type">No value</span></td>
  </tr>
  <tr>
    <td>devicePixelRatio (from window Object)</td>
    <td><span id="window-devicePixelRatio">No value</span></td>
  </tr>
  <tr>
    <td>Resolution* (with devicePixelRatio applied)</td>
    <td><span id="screen-Resolution">No value</span></td>
  </tr>
</table>
<script>
let array = []
if(window.DeviceMotionEvent)
  window.addEventListener("devicemotion", onDeviceMotion);
else array.push("devicemotion-acceleration", "devicemotion-accelerationIncludingGravity", "devicemotion-rotationRate", "devicemotion-interval");
if(window.DeviceLightEvent)
  window.addEventListener("devicelight", onDeviceLight);
else array.push("devicelight-value");
if(window.DeviceOrientationEvent)
  window.addEventListener("deviceorientation", onDeviceOrientation);
else array.push("deviceorientation-absolute", "deviceorientation-alpha", "deviceorientation-beta", "deviceorientation-gamma");
if(window.DeviceProximityEvent)
  window.addEventListener("deviceproximity", onDeviceProximity);
else array.push("deviceproximity-max", "deviceproximity-min", "deciveproximity-value");
if(window.UserProximityEvent)
  window.addEventListener("userproximity", onUserProximity);
else array.push("userproximity-near");
document.addEventListener("DOMContentLoaded", onLoad);
window.addEventListener("online", updateOnlineStatus);
window.addEventListener("offline", updateOnlineStatus);
window.addEventListener("vrdisplayconnected", VRs);
window.addEventListener("vrdisplaydisconnected", VRs);
window.addEventListener("vrdisplaypresentchange", VRs);
//window.addEventListener("orientationchange", onOrientationChange);
if(screen.addEventListener)
  screen.addEventListener("mozorientationchange", (e)=>setTimeout(()=>onOrientationChange(e), 50));


function onDeviceMotion(e){
  let props = ["acceleration", "accelerationIncludingGravity", "rotationRate", "interval"], i = props.length;
  while(i--){
    document.getElementById("devicemotion-"+props[i]).innerHTML = JSON.stringify(e[props[i]], null, "\t");
  }
}

function onDeviceLight(e){
  document.getElementById("devicelight").innerHTML = JSON.stringify(e.value, null, "\t");
}

function onDeviceOrientation(e){
  let props = ["absolute", "alpha", "beta", "gamma"], i = props.length;
  while(i--){
    document.getElementById("deviceorientation-"+props[i]).innerHTML = JSON.stringify(e[props[i]], null, "\t");
  }
}

function onDeviceProximity(e){
  let props = ["max", "min", "value"], i = props.length;
  while(i--){
    document.getElementById("deviceproximity-"+props[i]).innerHTML = JSON.stringify(e[props[i]], null, "\t");
  }
}

function onUserProximity(e){
  document.getElementById("userproximity-near").innerHTML = JSON.stringify(e.near, null, "\t");
}

function onLoad(){
  document.getElementById("navigator-activeVRDisplays").innerHTML = JSON.stringify(navigator.activeVRDisplays);
  document.getElementById("navigator-languages").innerHTML = JSON.stringify(navigator.languages);
  document.getElementById("navigator-hardwareConcurrency").innerHTML = JSON.stringify(navigator.hardwareConcurrency);
  document.getElementById("navigator-getGamepads").innerHTML = JSON.stringify(navigator.getGamepads());
  VRs();
  document.getElementById("navigator-maxTouchPoints").innerHTML = JSON.stringify(navigator.maxTouchPoints);
  document.getElementById("navigator-onLine").innerHTML = JSON.stringify(navigator.onLine);
  document.getElementById("navigator-oscpu").innerHTML = JSON.stringify(navigator.oscpu);
  navigator.getBattery().then(battery=>{
    document.getElementById("battery-charging").innerHTML = JSON.stringify(battery.charging);
    document.getElementById("battery-level").innerHTML = JSON.stringify(battery.level);
    document.getElementById("battery-chargingTime").innerHTML = JSON.stringify(battery.chargingTime);
    document.getElementById("battery-dischargingTime").innerHTML = JSON.stringify(battery.dischargingTime);
    battery.addEventListener("chargingchange", ()=>document.getElementById("battery-charging").innerHTML = JSON.stringify(battery.charging));
    battery.addEventListener("levelchange", ()=>document.getElementById("battery-level").innerHTML = JSON.stringify(battery.level));
    battery.addEventListener("chargingtimechange", ()=>document.getElementById("battery-chargingTime").innerHTML = JSON.stringify(battery.chargingTime));
    battery.addEventListener("dischargingtimechange", ()=>document.getElementById("battery-dischargingTime").innerHTML = JSON.stringify(battery.dischargingTime));
  });
  onOrientationChange();
  updateOnlineStatus();
}

function vibrateSample(){
  navigator.vibrate(1000);
}

function vibrateSOS(){
  navigator.vibrate([250, 50, 250, 50, 250, 50, 400, 50, 400, 50, 400, 50, 250, 50, 250, 50, 250]);
}

function VRs(){
  if(navigator.getVRDisplays){
    navigator.getVRDisplays().then(VRs=>document.getElementById("navigator-getVRDisplays").innerHTML = JSON.stringify(VRs));
  }
}

function updateOnlineStatus(e){
  document.getElementById("navigator-onLine").innerHTML = JSON.stringify(navigator.onLine);
}

function onOrientationChange(e){
  console.log("on orientation change");
  console.log(e);
  console.log(screen.orientation);
  console.log(screen.mozOrientation);
  console.log(e.target.orientation);
  console.log(e.target.mozOrientation);
  let props = ["availWidth", "availHeight", "width", "height", "colorDepth", "pixelDepth"], orientationProps = ["angle", "type"], i = props.length;
  while(i--){
    document.getElementById("screen-"+props[i]).innerHTML = screen[props[i]];
  }
  i = orientationProps.length;
  while(i--){
    document.getElementById("screen-orientation."+orientationProps[i]).innerHTML = screen.orientation[orientationProps[i]];
  }
  document.getElementById("window-devicePixelRatio").innerHTML = window.devicePixelRatio;
  document.getElementById("screen-Resolution").innerHTML = (screen.width*window.devicePixelRatio)+"x"+(screen.height*window.devicePixelRatio);
}
</script>
